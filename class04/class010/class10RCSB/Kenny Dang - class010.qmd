---
title: "class010: Structural Bioinformatics (pt. 1)"
author: "Kenny Dang (PID: A18544481)"
format: pdf
---

## The PDB database

The [Protein Data Bank (PDB)](http://www.rcsb.org/) is the main repository of biomolecular structure data. Let's see what is in it: 

```{r}
PDB <- read.csv("pdb_stats.csv", row.names = 1)
PDB
head(PDB)
```

> Q1. What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

81% of structures are solved by X-ray. 13% of structures are solved by Electron Microscopy. 

```{r}
n.sums <- colSums(PDB)
n <- n.sums/n.sums["Total"]
round(n, digits = 2)
```

> Q2. What proportion of structures in the PDB are protein? 

The proportion of structures in the PDB that are protein are 86%. 
```{r}
protein_total <- PDB["Protein (only)", "Total"]
protein_total
overall_total <- sum(PDB$Total)
overall_total
proportion <- protein_total / overall_total
proportion
round(proportion, digits = 2)

```


> Q3. Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB? 


After typing HIV in the PDB website search box, there are 2,427 HIV-1 protease structures in the current PDB. 



> What is the total number of entries in the PDB

The total number of entries in the PDB are 249018. 

```{r}
n.sums["Total"]
```
## Using Molstar

We can use the main [Molstar viewer online] ( https://molstar.org/viewer/) 

![first view of HIV-Pr dimer with bound inhibitor](sfpng.png)

> Q. Generate and Insert an image of the HIV-Pr cartoon colored by secondary structure, showing the inihibitor (ligand) in ball and stick. 

![first view of HIV-Pr showing the inhibitor in ball and stick](HIVbs.png)


> Q. One final image showing catalytic APS 25 as ball and stick and the all-important activties
![first view of catalytic APS 25 as ball and stick and the all-important activities](asp25.png)




> Q4. Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

Water (H2O) has three atoms, but in X-ray crystallography the hydrogen atoms barely scatter X-rays because they have very little electrons. Only the oxygen atom has enough electrons too be easily identified by the X-ray crystallography. Hydrogen atoms have very few electrons so it contributes almost no signal so they are usually invisible in electron-density maps. Meanwhile, the oxygen atom is detectable since it is more electron-dense. Therefore, this is why we just see one atom per water molecule in this structure. 

> Q5. There is a critical "conserved" water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have?

Yes I was able to identify the critical "conserved" water molecule in the binding site. The water molecule is HOH 326 and it most likely participates in catalysis. 


> Q6. Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend "Ball & Stick" for these side-chains). Add this figure to your Quarto document. 

![first view of HIV-Pr along with ligand](asp25.png)




Discussion Topic: can you think of a way in which indinavir, or even larger ligands and substrates could enter the binding site?

The indinavir and other larger ligands can enter the binding site through transient opening of the flexible flap regions of the HIV-1 protease which provides access to the active site. So the ligand enters when the flaps adopt an open conformation, the ligand diffuses into the active site, and then the flaps close over the ligand, trapping it in place. This is known as an induced fit. 



```{r}
library(bio3d)

png1 <- read.pdb("1hsg")
png1
```

```{r}
head(png1$atom)
```


```{r}
pdbseq(png1)
```
> Q7. How many amino acid residues are there in this pdb object?

```{r}
# Counts aminoâ€‘acid residues across all chains in a PDB object
aa_filter <- png1$atom$resid %in% c(
  "ALA","ARG","ASN","ASP","CYS",
  "GLU","GLN","GLY","HIS","ILE",
  "LEU","LYS","MET","PHE","PRO",
  "SER","THR","TRP","TYR","VAL"
)
pairs <- paste(
  png1$atom$chain[aa_filter],
  png1$atom$resno[aa_filter],
  sep = "_"
)
length(unique(pairs))
```

> Q8. Name one of the two non-protein residues?

HOH is one of the two non-protein residue. 

```{r}
unique(png1$atom$resid)
```



> Q9. How many protein chains are in this structure? 

There are 2 protein chains in this structure.

```{r}
aa <- c("ALA","ARG","ASN","ASP","CYS",
        "GLU","GLN","GLY","HIS","ILE",
        "LEU","LYS","MET","PHE","PRO",
        "SER","THR","TRP","TYR","VAL")

aa_filter <- png1$atom$resid %in% aa

protein_chains <- unique(png1$atom$chain[aa_filter])
length(protein_chains)
```




### Install -- Install packages in the R console NOT your Rmd/Quarto file

install.packages("bio3d")
install.packages("NGLVieweR")

install.packages("remotes")
remotes::install_github("bioboot/bio3dview")

install.packages("BiocManager")
BiocManager::install("msa")

> Q10. Which of the packages above is found only on BioConductor and not CRAN?

msa is found onnly on BioConductor and not CRAN.

> Q11. Which of the above packages is not found on BioConductor or CRAN?

bio3dview is not found on BioConductor or CRAN.

> Q12. True or False? Functions from the pak package can be used to install packages from GitHub and BitBucket? 

TRUE


Let's try out the new **bio3dview** package that is not yet on CRAN
We can use the **remotes** package to install any R package from GitHub.




```{r}
library(bio3dview)

view.pdb(png1)
view.pdb(png1, colorScheme = "sse")
```


## Quick viewing of PDBs


```{r}
library(bio3dview)

sele <- atom.select(png1, resno=25)

view.pdb(png1, backgroundColor = "pink",
         highlight = sele,
         highlight.style = "spacefill")
```



### Prediction of Protein Flexibility

```{r}
adk <- read.pdb("6s36")
m <- nma(adk)
plot(m)
```

Write out our results as a wee trajectory movie:



mktrj(m, file="results.pdb")

view.nma(m)




```{r}
library(bio3d)

aa <- get.seq("1ake_A")
aa
```


> Q13. How many amino acids are in this sequence, i.e. how long is this sequence? 

There are 214 amino acids in this sequence. 

```{r}
length(aa$ali)
```









