---
title: "CLASS 5 DATA VIZ WITH GGPLOT"
author: "KENNY DANG (PID:A18544481)"
format: pdf
toc: true 
---

## Background
There are lots of ways to make plots in R. These include so-called "base R" (like the `plot()`) and add on packages like **ggplot2**

Lets make the same plot with these two graphics systems. We can use the inbuilt `cars` dataset:

```{r}
head(cars)
```

With "base R" we can simply:

```{r}
plot(cars)
```
Now lets try ggplot. First I need to install the package using `install.packages("ggplot2")'
> **N.B.** We never run an `install.packages()` in a code chunk that otherwise we will re-install needlessly every time we render our document

every time we want to use an add-on package we need to load it up with a call to 'library()'

```{r}
library(ggplot2)
ggplot(cars)
```

Every ggplot needs at least three things: 

1. the **data** i.e. stuff to plot as a data.frame
2. the **aes** or aesthetics that map the data to the plot 
3. the **geom_** or geometry i.e. the plot type such as points, lines etc. 

install.packages("ggplot2")




```{r}
ggplot(cars) + aes(x=speed, y=dist) +geom_point() + geom_line()
       
```


```{r}
ggplot(cars) + aes(x=speed, y=dist) + geom_point() +geom_smooth ()
```

```{r}
ggplot(cars) + 
  aes(x=speed, y=dist) + geom_point()+ 
  geom_smooth(method = "lm", se=FALSE) +  
  labs(x="Speed (MPH)", y ="Distance (ft)", Title = "stopping Distance of old Cars") + theme_bw()
```



## gene expression plot

read some data on the effects of GLP-1 inhibitor (drug) on gene expression values:

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

Version 1 plot - start simple by getting some ink on the page

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
ggplot(genes) +
  aes(x= Condition1, y=Condition2) +
  geom_point(col="blue", alpha = 0.2)
```

Let's color by `State` up, down or no change

```{r}
table(genes$State)
```
library(ggplot2)
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
ggplot(genes) + aes(x=Condition1, y=Condition2, col=State) + geom_point() + scale_color_manual (values=c("purple","gray","orange")) + labs(x = "Control (no drug)", y="Drug Treatment", title = "Gene Expression Changes Upon Drug Treatment")
```
## going further with gapminder
here we explore the famous `gapminder`

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```

> Q. How many rows does this dataset have?

```{r}
nrow(gapminder)
```
>How many different continents are in this dataset

```{r}
table(gapminder$continent)
```
## Version 1 plot gdpPercap vs. LifeExp for all rows

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
head(gapminder)
ggplot(gapminder) + aes(x = gdpPercap, lifeExp, col=continent) + geom_point()
```
I want to see a plot for each continent -- in ggplot language this is called "faceting" 

```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
head(gapminder)
ggplot(gapminder) + aes(x = gdpPercap, lifeExp, col=continent) + geom_point() + facet_wrap(~continent)
```
##First look at the dplyr package

Another add on package with a function called 'filter()' that we want to use

install.packages("dplyr")

```{r}
library(dplyr)
```
```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
filter(gapminder, year == 2007, country == "Ireland")
```
```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
filter(gapminder, year == 2007, country == "United States")
```


```{r}
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
input <- filter(gapminder, year == 2007 | year == 1977)
```

```{r}
library(ggplot2)
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"
gapminder <- read.delim(url)
input <- filter(gapminder, year == 2007 | year == 1977)
ggplot(input) + 
  geom_point(aes(x = gdpPercap, y= lifeExp, color=continent)) + 
  facet_wrap(~year)
```

